<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/svg+xml" href="../../assets/img/favicon-test-tube.svg">
  <script src="../../assets/js/theme-init.js"></script>
  <title>Material Selector Lab | Integrated Science Tools</title>
  <link rel="stylesheet" href="../../assets/css/site.css">
  <link rel="stylesheet" href="../../assets/css/sims/sim-base.css">
  <script src="../../assets/js/site.js" defer></script>
  <script src="../../assets/js/sim-enhancer.js" defer></script>
  <link rel="stylesheet" href="../../assets/css/sims/material-selector.css">
</head>
<body data-site-root="../.." data-page="unit-2" data-sim-page="material-selector">
  <header id="site-header" class="site-header"></header>

  <main class="page-main">
    <section class="sim-wrap">
      <div class="container">
        <div class="top-actions">
          <a href="../index.html">Back to Unit 2</a>
          <a href="../../index.html">Home</a>
        </div>

        <h1>Material Selector Lab</h1>
        <p class="subtitle">Balance strength, cost, and mass priorities to justify engineering choices.</p>

        <section class="instructions" aria-label="Instructions">
          <h2>How To Use</h2>
          <ol>
            <li>Pick a preset scenario or start from balanced priorities.</li>
            <li>Adjust the three weighting sliders for your design goals.</li>
            <li>Read the ranked cards and compare score differences.</li>
            <li>Use the result metrics and interpretation block to explain your choice.</li>
          </ol>
        </section>

        <div class="sim-toolbar">
          <div class="scenario-presets preset-actions" role="group" aria-label="Preset scenarios">
            <button class="preset-btn active" type="button" data-scenario="balanced">Balanced Project</button>
            <button class="preset-btn" type="button" data-scenario="aerospace">Aerospace</button>
            <button class="preset-btn" type="button" data-scenario="budget">Budget Build</button>
            <button class="preset-btn" type="button" data-scenario="industrial">Heavy Industry</button>
          </div>
          <div class="toolbar-end">
            <button class="btn-reset" id="resetBtn" type="button">Reset</button>
          </div>
        </div>

        <div class="workspace">
          <section class="panel input-panel" aria-label="Priority inputs">
            <h2 class="panel-title">Priority Settings</h2>

            <div class="slider-row">
              <div class="slider-label">
                <label for="strength">Strength Priority</label>
                <span class="slider-value" id="wS">50</span>
              </div>
              <input id="strength" type="range" min="0" max="100" step="1" value="50">
            </div>

            <div class="slider-row">
              <div class="slider-label">
                <label for="cost">Low-Cost Priority</label>
                <span class="slider-value" id="wC">50</span>
              </div>
              <input id="cost" type="range" min="0" max="100" step="1" value="50">
            </div>

            <div class="slider-row">
              <div class="slider-label">
                <label for="mass">Low-Mass Priority</label>
                <span class="slider-value" id="wM">50</span>
              </div>
              <input id="mass" type="range" min="0" max="100" step="1" value="50">
            </div>
          </section>

          <section class="panel output-panel" aria-label="Material comparison outputs">
            <h2 class="panel-title">Material Model</h2>

            <div class="model-panel">
              <div class="material-cards" id="cards" role="list" aria-label="Ranked material cards"></div>
            </div>

            <div class="result-cards">
              <article class="result-card">
                <p class="result-label">Recommended Material</p>
                <p class="result-value" id="rec-name">-</p>
              </article>
              <article class="result-card">
                <p class="result-label">Top Score</p>
                <p class="result-value"><span id="top-score">0.0</span></p>
              </article>
              <article class="result-card">
                <p class="result-label">Runner-up Gap</p>
                <p class="result-value"><span id="score-gap">0.0</span></p>
              </article>
            </div>

            <div class="status-block">
              <p class="status-label">Interpretation</p>
              <p class="status-badge" id="status">Balanced recommendation</p>
              <p class="status-note" id="note">Adjust priorities to see when lightweight or low-cost options overtake stronger materials.</p>
            </div>
          </section>
        </div>
      </div>
    </section>
  </main>

  <footer id="site-footer" class="site-footer"></footer>

  <script>
    (() => {
      const materials = [
        { name: "Aluminum", strength: 70, cost: 60, mass: 75, description: "Balanced strength-to-weight choice for many structures." },
        { name: "Steel", strength: 90, cost: 45, mass: 30, description: "High structural strength with low cost, but heavy." },
        { name: "Carbon Fiber", strength: 95, cost: 20, mass: 95, description: "Very strong and very light, but premium cost." },
        { name: "ABS Plastic", strength: 45, cost: 80, mass: 85, description: "Low-cost lightweight option for lower-load applications." },
        { name: "Titanium", strength: 92, cost: 15, mass: 70, description: "Excellent strength and good mass profile with high cost." }
      ];

      const defaults = { strength: 50, cost: 50, mass: 50 };

      const scenarios = {
        balanced: { strength: 50, cost: 50, mass: 50 },
        aerospace: { strength: 90, cost: 30, mass: 95 },
        budget: { strength: 40, cost: 95, mass: 40 },
        industrial: { strength: 95, cost: 60, mass: 20 }
      };

      const el = {
        strength: document.getElementById("strength"),
        cost: document.getElementById("cost"),
        mass: document.getElementById("mass"),
        wS: document.getElementById("wS"),
        wC: document.getElementById("wC"),
        wM: document.getElementById("wM"),
        cards: document.getElementById("cards"),
        recName: document.getElementById("rec-name"),
        topScore: document.getElementById("top-score"),
        scoreGap: document.getElementById("score-gap"),
        status: document.getElementById("status"),
        note: document.getElementById("note"),
        resetBtn: document.getElementById("resetBtn"),
        presetButtons: document.querySelectorAll(".preset-btn")
      };

      const state = {
        activeScenario: "balanced"
      };

      function clamp(value, min, max) {
        return Math.max(min, Math.min(max, Number(value)));
      }

      function scoreMaterial(material, weights) {
        return (material.strength * weights.strength + material.cost * weights.cost + material.mass * weights.mass) / 100;
      }

      function classify(top, gap, weights) {
        const dominant = Object.entries(weights).sort((a, b) => b[1] - a[1])[0][0];

        if (gap >= 12) {
          return {
            badge: "Clear winner",
            note: `${top.name} strongly matches your selected priorities with a large lead.`
          };
        }

        if (dominant === "cost") {
          return {
            badge: "Cost-driven tradeoff",
            note: "Lower cost weighting is dominating selection, even if high-end materials are stronger."
          };
        }

        if (dominant === "mass") {
          return {
            badge: "Weight-driven tradeoff",
            note: "Lightweight priorities are favoring materials with strong mass performance."
          };
        }

        return {
          badge: "Strength-focused tradeoff",
          note: "High strength weighting is prioritizing structural performance over budget and mass."
        };
      }

      function setActiveScenario(scenarioKey) {
        state.activeScenario = scenarioKey;
        el.presetButtons.forEach((button) => {
          button.classList.toggle("active", button.dataset.scenario === scenarioKey);
        });
      }

      function renderCards(scored) {
        el.cards.innerHTML = scored.map((material, index) => {
          const rank = index + 1;
          return `
            <article class="material-card ${index === 0 ? "best" : ""}" data-material="${material.name}" role="listitem" aria-label="Rank ${rank}: ${material.name}">
              <div class="material-header">
                <p class="material-name">${material.name}</p>
                <p class="material-score">${material.s.toFixed(1)}</p>
              </div>
              <p class="material-rank">Rank ${rank}</p>
              <div class="material-stats">
                <div class="stat">
                  <p class="stat-label">Strength</p>
                  <div class="stat-bar"><div class="stat-fill" style="width:${clamp(material.strength, 0, 100)}%"></div></div>
                </div>
                <div class="stat">
                  <p class="stat-label">Low Cost</p>
                  <div class="stat-bar"><div class="stat-fill" style="width:${clamp(material.cost, 0, 100)}%"></div></div>
                </div>
                <div class="stat">
                  <p class="stat-label">Low Mass</p>
                  <div class="stat-bar"><div class="stat-fill" style="width:${clamp(material.mass, 0, 100)}%"></div></div>
                </div>
              </div>
            </article>
          `;
        }).join("");
      }

      function update() {
        const weights = {
          strength: clamp(el.strength.value, 0, 100),
          cost: clamp(el.cost.value, 0, 100),
          mass: clamp(el.mass.value, 0, 100)
        };

        el.wS.textContent = weights.strength.toFixed(0);
        el.wC.textContent = weights.cost.toFixed(0);
        el.wM.textContent = weights.mass.toFixed(0);

        const scored = materials
          .map((material) => ({ ...material, s: scoreMaterial(material, weights) }))
          .sort((a, b) => b.s - a.s);

        renderCards(scored);

        const best = scored[0];
        const second = scored[1] || scored[0];
        const gap = Math.max(0, best.s - second.s);
        const classification = classify(best, gap, weights);

        el.recName.textContent = best.name;
        el.topScore.textContent = best.s.toFixed(1);
        el.scoreGap.textContent = gap.toFixed(1);
        el.status.textContent = classification.badge;
        el.note.textContent = `${classification.note} ${best.description}`;
      }

      function applyScenario(scenarioKey) {
        const scenario = scenarios[scenarioKey];
        if (!scenario) return;
        el.strength.value = scenario.strength;
        el.cost.value = scenario.cost;
        el.mass.value = scenario.mass;
        setActiveScenario(scenarioKey);
        update();
      }

      [el.strength, el.cost, el.mass].forEach((input) => {
        input.addEventListener("input", () => {
          setActiveScenario("");
          update();
        });
      });

      el.presetButtons.forEach((button) => {
        button.addEventListener("click", () => applyScenario(button.dataset.scenario));
      });

      el.resetBtn.addEventListener("click", () => {
        el.strength.value = defaults.strength;
        el.cost.value = defaults.cost;
        el.mass.value = defaults.mass;
        setActiveScenario("balanced");
        update();
      });

      applyScenario("balanced");
    })();
  </script>
</body>
</html>
